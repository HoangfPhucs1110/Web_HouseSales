@model IEnumerable<Web_HouseSale.Models.Product>
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    var page = (int)(ViewBag.Page ?? 1);
    var totalPages = (int)(ViewBag.TotalPages ?? 1);
    var sort = (int)(ViewBag.Sort ?? 1);

    Func<Web_HouseSale.Models.Product, string> firstImg = p =>
        !string.IsNullOrWhiteSpace(p.ImageUrl) ? p.ImageUrl :
        !string.IsNullOrWhiteSpace(p.ImageUrl2) ? p.ImageUrl2 :
        !string.IsNullOrWhiteSpace(p.ImageUrl3) ? p.ImageUrl3 :
        (!string.IsNullOrWhiteSpace(p.ImageUrl4) ? p.ImageUrl4 : "~/img/product01.png");
}

<!-- optional: giúp thẻ đều nhau -->
<style>
    #store .product-img img {
        width: 100%;
        height: 220px;
        object-fit: contain;
        display: block;
    }
</style>

<!-- BREADCRUMB -->
<div id="breadcrumb" class="section">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <ul class="breadcrumb-tree">
                    <li><a href="@Url.Action("Index","Home")">Home</a></li>
                    <li class="active">Store</li>
                </ul>
            </div>
        </div>
    </div>
</div>
<!-- /BREADCRUMB -->
<!-- SECTION -->
<div class="section">
    <div class="container">
        <div class="row">
            <!-- ASIDE -->
            <div id="aside" class="col-md-3">
                <div class="aside">
                    <h3 class="aside-title">Brand</h3>
                    <div class="checkbox-filter">
                        <div class="input-checkbox"><input type="checkbox" id="brand-1"><label for="brand-1"><span></span>Iphone</label></div>
                        <div class="input-checkbox"><input type="checkbox" id="brand-2"><label for="brand-2"><span></span>Samsung</label></div>
                        <div class="input-checkbox"><input type="checkbox" id="brand-3"><label for="brand-3"><span></span>Xiaomi</label></div>
                        <div class="input-checkbox"><input type="checkbox" id="brand-4"><label for="brand-4"><span></span>Vivo</label></div>
                    </div>
                </div>
            </div>
            <!-- /ASIDE -->
            <!-- STORE -->
            <div id="store" class="col-md-9">

                <!-- store top filter -->
                <div class="store-filter clearfix">
                    <div class="store-sort">
                        @using (Html.BeginForm("Index", "Store", FormMethod.Get, new { @class = "form-inline" }))
                        {
                            <label>
                                Sort By:
                                <select name="sort" class="input-select" onchange="this.form.submit()">
                                    <option value="1" @(sort == 1 ? "selected" : "")>Newest</option>
                                    <option value="2" @(sort == 2 ? "selected" : "")>Oldest</option>
                                    <option value="3" @(sort == 3 ? "selected" : "")>Price(High To Low)</option>
                                    <option value="4" @(sort == 4 ? "selected" : "")>Price(Low To High)</option>
                                </select>
                            </label>
                            <input type="hidden" name="page" value="1" />
                        }
                    </div>
                </div>
                <!-- /store top filter -->
                <!-- store products -->
                <div class="row">
                    @foreach (var p in Model)
                    {
                        <div class="col-md-4 col-sm-6 col-xs-6">
                            <div class="product">
                                <div class="product-img">
                                    <img src="@Url.Content(firstImg(p))" alt="@p.Name" />
                                    <div class="product-label">
                                        @if (p.SalePercent.HasValue && p.SalePercent.Value > 0)
                                        {<span class="sale">-@p.SalePercent%</span>}
                                        @if (p.IsNew)
                                        {<span class="new">NEW</span>}
                                    </div>
                                </div>
                                <div class="product-body">
                                    <p class="product-category">@p.Category</p>
                                    <h3 class="product-name">
                                        <a href="@Url.Action("Details","Product", new { slug = p.Slug })">@p.Name</a>
                                    </h3>
                                    <h4 class="product-price">
                                        @p.Price.ToString("c")
                                        @if (p.OldPrice.HasValue)
                                        {<del class="product-old-price">@p.OldPrice.Value.ToString("c")</del>}
                                    </h4>
                                </div>
                            </div>
                        </div>
                    }
                </div>
                <!-- /store products -->
                <!-- store bottom filter (pagination) -->
                <div class="store-filter clearfix">
                    <span class="store-qty">
                        Page @page of @totalPages
                    </span>
                    <ul class="store-pagination">
                        @if (page > 1)
                        {
                            <li><a href="@Url.Action("Index","Store", new { page = page-1, sort = sort })"><i class="fa fa-angle-left"></i></a></li>
                        }
                        @for (int i = 1; i <= totalPages; i++)
                        {
                            if (i == page)
                            {
                                <li class="active">@i</li>
 }
                            else
                            {
                                <li><a href="@Url.Action("Index","Store", new { page = i, sort = sort })">@i</a></li>
}
                        }
                        @if (page < totalPages)
                        {
                            <li><a href="@Url.Action("Index","Store", new { page = page+1, sort = sort })"><i class="fa fa-angle-right"></i></a></li>
                        }
                    </ul>
                </div>
                <!-- /store bottom filter -->

            </div>
            <!-- /STORE -->
        </div>
    </div>
</div>
<!-- /SECTION -->
